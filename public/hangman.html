<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hangman</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
  <script src="javascripts/hangman.js"></script>
</head>
<body>
<div class="modal" id="youLose" tabindex="-1" role="dialog" aria-labelledby="youLoseLabel"
     aria-hidden="false">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="youLoseLabel">YOU LOSE</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Thanks for playing, but you have lost. Want to play again?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Let's Play Again</button>
                <button data-dismiss="modal" type="button"
                        class="btn btn-primary">Nope!</button>
            </div>
        </div>
    </div>
</div>

<div class="slidecontainer">
  <label for="customRange3" class="form-label">Maximum number of letters in word</label>
  <input onclick="slider()" type="range" class="form-range" min="1" max="7" step="1" id="customRange3"
         style="width:
  30%">
  <div id="rangeDisplay" style="width: 30%; float: left;"></div>

</div>



<button onclick="selectOption('food')" type="button" class="btn btn-primary" id="catFood">Food</button>
<button onclick="selectOption('animals')" type="button" class="btn btn-primary" id="catAnimals">Animals</button>

<div class="input-group mb-3">
    <input type="text" class="form-control" placeholder="Guess" aria-label="Guess"
           aria-describedby="basic-addon2" id="playersGuess">
    <div class="input-group-append">
        <button onclick="guessALetter(document.getElementById('playersGuess').value)" class="btn btn-outline-secondary"
        type="button">Guess!</button>
    </div>
</div>

<progress value="0" max="100" id="errorProgressBar">Error</progress>

<div class="alert alert-primary" role="alert" id="">
    Word: <p id="currentWordShown">___________</p>
</div>

<div class="alert alert-primary" id="guessedLetters">
    Guessed Letters
    <hr>
    <p id="guessedLettersDisplay"></p>
</div>



  <script>
      let category = "";
      let count = 4;
      var wordToGuess = "potato";
      let guessedLetters = [];
      let incorrectGuesses = 0;

      function slider() {
          count = document.getElementById("customRange3").value;
          document.getElementById("rangeDisplay").innerHTML = count;
      }

      function selectOption(option) {
          category = option;
          document.getElementById("catFood").disabled = true;
          document.getElementById("catAnimals").disabled = true;
      }

      function guessALetter(currGuess) {
          if(incorrectGuesses < 5) {
              if (guessedLetters.length === 0)
                  document.getElementById("guessedLettersDisplay").innerHTML = currGuess;
              else {
                  document.getElementById("guessedLettersDisplay").innerHTML =
                      document.getElementById("guessedLettersDisplay").innerHTML + ","
                      + currGuess;
              }
              guessedLetters.push(currGuess);
              let positions = [];
              for (let i = 0; i < wordToGuess.length; i++) {
                  if (wordToGuess[i] === currGuess) {
                      guessedLetters.push(i);
                      console.log("Pushing " + i);
                  }
              }

              if (positions.length === 0) {
                  incorrectGuesses++;
                  if(incorrectGuesses === 5){
                      $("#youLose").modal("show");
                  }
              }


              replaceBlanks(positions);
              console.log("replaceBlanks");
          } else {
              console.log("Toggle Time");
              $("#youLose").modal("show");
          }
      }

      function replaceBlanks(positions){
          let displayNew = "";
          console.log(positions);
          console.log("Length " + wordToGuess.length);
          for(let i = 0; i < wordToGuess.length; i++){
              if (guessedLetters.includes(i)) {
                  console.log(wordToGuess[i]);
                  displayNew = displayNew.concat(wordToGuess[i]);
              }
              else {
                  console.log(i);
                  displayNew = displayNew.concat("_ ");
              }
          }

          document.getElementById("currentWordShown").innerText = displayNew;
          updateIncorrectAnswers();
      }


      function updateIncorrectAnswers(){
          let newVal = (incorrectGuesses * (100/5))
          console.log("Val: " + newVal);
          document.getElementById("errorProgressBar").value = newVal;
      }
  </script>
</body>
</html>